{
  "version": 4,
  "terraform_version": "1.7.4",
  "serial": 256,
  "lineage": "f3377c51-42d1-fde8-ab20-f0d66b4c305c",
  "outputs": {
    "app_client_id": {
      "value": "5pa9rqp0gkkivk3ttek5v8dov7",
      "type": "string"
    },
    "cloudfront_url": {
      "value": "https://d1oa4h4op5s1tl.cloudfront.net",
      "type": "string"
    },
    "user_pool_id": {
      "value": "us-west-2_odqCHUdYl",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "archive_file",
      "name": "presigned_url_lambda_zip",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "exclude_symlink_directories": null,
            "excludes": null,
            "id": "4853f776c327d8ae0d58c9579805aa526d9226ca",
            "output_base64sha256": "QbXoB0gX7Wg8QqQmdlNTJ+EGRHxqOD/Ucsw2k9QYuI8=",
            "output_base64sha512": "R25UAkJpk0HmqSPtsDdLXCr0kHqRiw2U9NKXTKtMoM1KutbqgXJibKzl+zoDixVjgrzlSj01Re+1bTN0dQYVZg==",
            "output_file_mode": null,
            "output_md5": "d96fd0f105c5e8b183a4c6b7c1653cbb",
            "output_path": "./lambda_functions/presigned_url_lambda.zip",
            "output_sha": "4853f776c327d8ae0d58c9579805aa526d9226ca",
            "output_sha256": "41b5e8074817ed683c42a42676535327e106447c6a383fd472cc3693d418b88f",
            "output_sha512": "476e540242699341e6a923edb0374b5c2af4907a918b0d94f4d2974cab4ca0cd4abad6ea8172626cace5fb3a038b156382bce54a3d3545efb56d337475061566",
            "output_size": 754,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": "./lambda_functions/presigned_url_lambda",
            "source_file": null,
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "archive_file",
      "name": "writer_lambda_zip",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "exclude_symlink_directories": null,
            "excludes": null,
            "id": "d1457e4a11c0dd8dc3826bf38e03ca549cc4ec4f",
            "output_base64sha256": "r12Ry2jHmXxu4/o4CITBcuhMB2zo+R0cfLYgOYTO2Fg=",
            "output_base64sha512": "uWin1pZfgA/S5ZH+uDYWr6+6EEKF42VUyjYkKmzN94FzVW89Cy6ZiUjsbnVh3f9r2JcOmEppNqUFBGExn3eGBQ==",
            "output_file_mode": null,
            "output_md5": "4f05283dd84f5710e36000ca73f4e351",
            "output_path": "./lambda_functions/writer_lambda.zip",
            "output_sha": "d1457e4a11c0dd8dc3826bf38e03ca549cc4ec4f",
            "output_sha256": "af5d91cb68c7997c6ee3fa380884c172e84c076ce8f91d1c7cb6203984ced858",
            "output_sha512": "b968a7d6965f800fd2e591feb83616afafba104285e36554ca36242a6ccdf78173556f3d0b2e998948ec6e7561ddff6bd8970e984a6936a5050461319f778605",
            "output_size": 678,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": "./lambda_functions/writer_lambda",
            "source_file": null,
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_authorizer",
      "name": "cognito",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:apigateway:us-west-2::/restapis/x3mflhf5w5/authorizers/cegbyn",
            "authorizer_credentials": "",
            "authorizer_result_ttl_in_seconds": 300,
            "authorizer_uri": "",
            "id": "cegbyn",
            "identity_source": "method.request.header.Authorization",
            "identity_validation_expression": "",
            "name": "CognitoAuthorizer",
            "provider_arns": [
              "arn:aws:cognito-idp:us-west-2:122996776574:userpool/us-west-2_odqCHUdYl"
            ],
            "rest_api_id": "x3mflhf5w5",
            "type": "COGNITO_USER_POOLS"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_rest_api.main",
            "aws_cognito_user_pool.main"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_deployment",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "canary_settings": [],
            "created_date": "2025-08-26T10:50:55Z",
            "description": "",
            "execution_arn": "arn:aws:execute-api:us-west-2:122996776574:x3mflhf5w5/",
            "id": "ymjka0",
            "invoke_url": "https://x3mflhf5w5.execute-api.us-west-2.amazonaws.com/",
            "rest_api_id": "x3mflhf5w5",
            "stage_description": null,
            "stage_name": null,
            "triggers": {
              "redeployment": "a066af0930f1a94a6a03e86296c483efbc237117"
            },
            "variables": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_authorizer.cognito",
            "aws_api_gateway_integration.results_get_dynamodb",
            "aws_api_gateway_integration.results_options_mock",
            "aws_api_gateway_integration.uploads_options_mock",
            "aws_api_gateway_integration.uploads_post_lambda",
            "aws_api_gateway_method.results_get",
            "aws_api_gateway_method.results_options",
            "aws_api_gateway_method.uploads_options",
            "aws_api_gateway_method.uploads_post",
            "aws_api_gateway_resource.results",
            "aws_api_gateway_resource.results_proxy",
            "aws_api_gateway_resource.uploads",
            "aws_api_gateway_rest_api.main",
            "aws_cloudfront_distribution.site",
            "aws_cognito_user_pool.main",
            "aws_dynamodb_table.rekognition_cache",
            "aws_iam_role.api_gateway_dynamodb_role",
            "aws_iam_role.presigned_url_lambda_role",
            "aws_lambda_function.presigned_url_lambda",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket.image_uploads",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "data.archive_file.presigned_url_lambda_zip",
            "random_string.suffix"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_integration",
      "name": "results_get_dynamodb",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cache_key_parameters": [],
            "cache_namespace": "a307c6",
            "connection_id": "",
            "connection_type": "INTERNET",
            "content_handling": "",
            "credentials": "arn:aws:iam::122996776574:role/ImageAnalyzerApiGatewayDynamoDBRole",
            "http_method": "GET",
            "id": "agi-x3mflhf5w5-a307c6-GET",
            "integration_http_method": "POST",
            "passthrough_behavior": "WHEN_NO_MATCH",
            "request_parameters": {},
            "request_templates": {
              "application/json": "{\"Key\":{\"ImageKey\":{\"S\":\"$input.params('imagekey')\"}},\"TableName\":\"ImageAnalyzerCache\"}"
            },
            "resource_id": "a307c6",
            "rest_api_id": "x3mflhf5w5",
            "timeout_milliseconds": 29000,
            "tls_config": [],
            "type": "AWS",
            "uri": "arn:aws:apigateway:us-west-2:dynamodb:action/GetItem"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_authorizer.cognito",
            "aws_api_gateway_method.results_get",
            "aws_api_gateway_resource.results",
            "aws_api_gateway_resource.results_proxy",
            "aws_api_gateway_rest_api.main",
            "aws_cognito_user_pool.main",
            "aws_dynamodb_table.rekognition_cache",
            "aws_iam_role.api_gateway_dynamodb_role"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_integration",
      "name": "results_options_mock",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cache_key_parameters": [],
            "cache_namespace": "a307c6",
            "connection_id": "",
            "connection_type": "INTERNET",
            "content_handling": "",
            "credentials": "",
            "http_method": "OPTIONS",
            "id": "agi-x3mflhf5w5-a307c6-OPTIONS",
            "integration_http_method": "",
            "passthrough_behavior": "WHEN_NO_MATCH",
            "request_parameters": {},
            "request_templates": {
              "application/json": "{ \"statusCode\": 200 }"
            },
            "resource_id": "a307c6",
            "rest_api_id": "x3mflhf5w5",
            "timeout_milliseconds": 29000,
            "tls_config": [],
            "type": "MOCK",
            "uri": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_method.results_options",
            "aws_api_gateway_resource.results",
            "aws_api_gateway_resource.results_proxy",
            "aws_api_gateway_rest_api.main"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_integration",
      "name": "uploads_options_mock",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cache_key_parameters": [],
            "cache_namespace": "sez1p7",
            "connection_id": "",
            "connection_type": "INTERNET",
            "content_handling": "",
            "credentials": "",
            "http_method": "OPTIONS",
            "id": "agi-x3mflhf5w5-sez1p7-OPTIONS",
            "integration_http_method": "",
            "passthrough_behavior": "WHEN_NO_MATCH",
            "request_parameters": {},
            "request_templates": {
              "application/json": "{ \"statusCode\": 200 }"
            },
            "resource_id": "sez1p7",
            "rest_api_id": "x3mflhf5w5",
            "timeout_milliseconds": 29000,
            "tls_config": [],
            "type": "MOCK",
            "uri": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_method.uploads_options",
            "aws_api_gateway_resource.uploads",
            "aws_api_gateway_rest_api.main"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_integration",
      "name": "uploads_post_lambda",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cache_key_parameters": [],
            "cache_namespace": "sez1p7",
            "connection_id": "",
            "connection_type": "INTERNET",
            "content_handling": "",
            "credentials": "",
            "http_method": "POST",
            "id": "agi-x3mflhf5w5-sez1p7-POST",
            "integration_http_method": "POST",
            "passthrough_behavior": "WHEN_NO_MATCH",
            "request_parameters": {},
            "request_templates": {},
            "resource_id": "sez1p7",
            "rest_api_id": "x3mflhf5w5",
            "timeout_milliseconds": 29000,
            "tls_config": [],
            "type": "AWS_PROXY",
            "uri": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:122996776574:function:ImageAnalyzerPresignedUrlLambda/invocations"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_authorizer.cognito",
            "aws_api_gateway_method.uploads_post",
            "aws_api_gateway_resource.uploads",
            "aws_api_gateway_rest_api.main",
            "aws_cloudfront_distribution.site",
            "aws_cognito_user_pool.main",
            "aws_iam_role.presigned_url_lambda_role",
            "aws_lambda_function.presigned_url_lambda",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket.image_uploads",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "data.archive_file.presigned_url_lambda_zip",
            "random_string.suffix"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_integration_response",
      "name": "results_get_200",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "content_handling": "",
            "http_method": "GET",
            "id": "agir-x3mflhf5w5-a307c6-GET-200",
            "resource_id": "a307c6",
            "response_parameters": {
              "method.response.header.Access-Control-Allow-Origin": "'https://d1oa4h4op5s1tl.cloudfront.net'"
            },
            "response_templates": {},
            "rest_api_id": "x3mflhf5w5",
            "selection_pattern": "",
            "status_code": "200"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_authorizer.cognito",
            "aws_api_gateway_method.results_get",
            "aws_api_gateway_method_response.results_get_200",
            "aws_api_gateway_resource.results",
            "aws_api_gateway_resource.results_proxy",
            "aws_api_gateway_rest_api.main",
            "aws_cloudfront_distribution.site",
            "aws_cognito_user_pool.main",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_integration_response",
      "name": "results_options_200",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "content_handling": "",
            "http_method": "OPTIONS",
            "id": "agir-x3mflhf5w5-a307c6-OPTIONS-200",
            "resource_id": "a307c6",
            "response_parameters": {
              "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
              "method.response.header.Access-Control-Allow-Methods": "'GET,OPTIONS'",
              "method.response.header.Access-Control-Allow-Origin": "'https://d1oa4h4op5s1tl.cloudfront.net'"
            },
            "response_templates": {},
            "rest_api_id": "x3mflhf5w5",
            "selection_pattern": "",
            "status_code": "200"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_method.results_options",
            "aws_api_gateway_method_response.results_options_200",
            "aws_api_gateway_resource.results",
            "aws_api_gateway_resource.results_proxy",
            "aws_api_gateway_rest_api.main",
            "aws_cloudfront_distribution.site",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_integration_response",
      "name": "uploads_options_200",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "content_handling": "",
            "http_method": "OPTIONS",
            "id": "agir-x3mflhf5w5-sez1p7-OPTIONS-200",
            "resource_id": "sez1p7",
            "response_parameters": {
              "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
              "method.response.header.Access-Control-Allow-Methods": "'POST,OPTIONS'",
              "method.response.header.Access-Control-Allow-Origin": "'https://d1oa4h4op5s1tl.cloudfront.net'"
            },
            "response_templates": {},
            "rest_api_id": "x3mflhf5w5",
            "selection_pattern": "",
            "status_code": "200"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_method.uploads_options",
            "aws_api_gateway_method_response.uploads_options_200",
            "aws_api_gateway_resource.uploads",
            "aws_api_gateway_rest_api.main",
            "aws_cloudfront_distribution.site",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_method",
      "name": "results_get",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "api_key_required": false,
            "authorization": "COGNITO_USER_POOLS",
            "authorization_scopes": [
              "openid"
            ],
            "authorizer_id": "cegbyn",
            "http_method": "GET",
            "id": "agm-x3mflhf5w5-a307c6-GET",
            "operation_name": "",
            "request_models": {},
            "request_parameters": {},
            "request_validator_id": "",
            "resource_id": "a307c6",
            "rest_api_id": "x3mflhf5w5"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_authorizer.cognito",
            "aws_api_gateway_resource.results",
            "aws_api_gateway_resource.results_proxy",
            "aws_api_gateway_rest_api.main",
            "aws_cognito_user_pool.main"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_method",
      "name": "results_options",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "api_key_required": false,
            "authorization": "NONE",
            "authorization_scopes": [],
            "authorizer_id": "",
            "http_method": "OPTIONS",
            "id": "agm-x3mflhf5w5-a307c6-OPTIONS",
            "operation_name": "",
            "request_models": {},
            "request_parameters": {},
            "request_validator_id": "",
            "resource_id": "a307c6",
            "rest_api_id": "x3mflhf5w5"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_resource.results",
            "aws_api_gateway_resource.results_proxy",
            "aws_api_gateway_rest_api.main"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_method",
      "name": "uploads_options",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "api_key_required": false,
            "authorization": "NONE",
            "authorization_scopes": [],
            "authorizer_id": "",
            "http_method": "OPTIONS",
            "id": "agm-x3mflhf5w5-sez1p7-OPTIONS",
            "operation_name": "",
            "request_models": {},
            "request_parameters": {},
            "request_validator_id": "",
            "resource_id": "sez1p7",
            "rest_api_id": "x3mflhf5w5"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_resource.uploads",
            "aws_api_gateway_rest_api.main"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_method",
      "name": "uploads_post",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "api_key_required": false,
            "authorization": "COGNITO_USER_POOLS",
            "authorization_scopes": [
              "openid"
            ],
            "authorizer_id": "cegbyn",
            "http_method": "POST",
            "id": "agm-x3mflhf5w5-sez1p7-POST",
            "operation_name": "",
            "request_models": {},
            "request_parameters": {},
            "request_validator_id": "",
            "resource_id": "sez1p7",
            "rest_api_id": "x3mflhf5w5"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_authorizer.cognito",
            "aws_api_gateway_resource.uploads",
            "aws_api_gateway_rest_api.main",
            "aws_cognito_user_pool.main"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_method_response",
      "name": "results_get_200",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "http_method": "GET",
            "id": "agmr-x3mflhf5w5-a307c6-GET-200",
            "resource_id": "a307c6",
            "response_models": {},
            "response_parameters": {
              "method.response.header.Access-Control-Allow-Origin": true
            },
            "rest_api_id": "x3mflhf5w5",
            "status_code": "200"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_authorizer.cognito",
            "aws_api_gateway_method.results_get",
            "aws_api_gateway_resource.results",
            "aws_api_gateway_resource.results_proxy",
            "aws_api_gateway_rest_api.main",
            "aws_cognito_user_pool.main"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_method_response",
      "name": "results_options_200",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "http_method": "OPTIONS",
            "id": "agmr-x3mflhf5w5-a307c6-OPTIONS-200",
            "resource_id": "a307c6",
            "response_models": {},
            "response_parameters": {
              "method.response.header.Access-Control-Allow-Headers": true,
              "method.response.header.Access-Control-Allow-Methods": true,
              "method.response.header.Access-Control-Allow-Origin": true
            },
            "rest_api_id": "x3mflhf5w5",
            "status_code": "200"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_method.results_options",
            "aws_api_gateway_resource.results",
            "aws_api_gateway_resource.results_proxy",
            "aws_api_gateway_rest_api.main"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_method_response",
      "name": "uploads_options_200",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "http_method": "OPTIONS",
            "id": "agmr-x3mflhf5w5-sez1p7-OPTIONS-200",
            "resource_id": "sez1p7",
            "response_models": {},
            "response_parameters": {
              "method.response.header.Access-Control-Allow-Headers": true,
              "method.response.header.Access-Control-Allow-Methods": true,
              "method.response.header.Access-Control-Allow-Origin": true
            },
            "rest_api_id": "x3mflhf5w5",
            "status_code": "200"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_method.uploads_options",
            "aws_api_gateway_resource.uploads",
            "aws_api_gateway_rest_api.main"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_resource",
      "name": "results",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "wt8mej",
            "parent_id": "2nie19hjlj",
            "path": "/results",
            "path_part": "results",
            "rest_api_id": "x3mflhf5w5"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_rest_api.main"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_resource",
      "name": "results_proxy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "a307c6",
            "parent_id": "wt8mej",
            "path": "/results/{imagekey}",
            "path_part": "{imagekey}",
            "rest_api_id": "x3mflhf5w5"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_resource.results",
            "aws_api_gateway_rest_api.main"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_resource",
      "name": "uploads",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "sez1p7",
            "parent_id": "2nie19hjlj",
            "path": "/uploads",
            "path_part": "uploads",
            "rest_api_id": "x3mflhf5w5"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_rest_api.main"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_rest_api",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "api_key_source": "HEADER",
            "arn": "arn:aws:apigateway:us-west-2::/restapis/x3mflhf5w5",
            "binary_media_types": [],
            "body": null,
            "created_date": "2025-08-26T10:46:40Z",
            "description": "API for the Serverless Image Analyzer",
            "disable_execute_api_endpoint": false,
            "endpoint_configuration": [
              {
                "ip_address_type": "ipv4",
                "types": [
                  "EDGE"
                ],
                "vpc_endpoint_ids": []
              }
            ],
            "execution_arn": "arn:aws:execute-api:us-west-2:122996776574:x3mflhf5w5",
            "fail_on_warnings": null,
            "id": "x3mflhf5w5",
            "minimum_compression_size": "",
            "name": "ImageAnalyzerAPI",
            "parameters": null,
            "policy": "",
            "put_rest_api_mode": null,
            "root_resource_id": "2nie19hjlj",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_api_gateway_stage",
      "name": "prod",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "access_log_settings": [],
            "arn": "arn:aws:apigateway:us-west-2::/restapis/x3mflhf5w5/stages/prod",
            "cache_cluster_enabled": false,
            "cache_cluster_size": "",
            "canary_settings": [],
            "client_certificate_id": "",
            "deployment_id": "ymjka0",
            "description": "",
            "documentation_version": "",
            "execution_arn": "arn:aws:execute-api:us-west-2:122996776574:x3mflhf5w5/prod",
            "id": "ags-x3mflhf5w5-prod",
            "invoke_url": "https://x3mflhf5w5.execute-api.us-west-2.amazonaws.com/prod",
            "rest_api_id": "x3mflhf5w5",
            "stage_name": "prod",
            "tags": {},
            "tags_all": {},
            "variables": {},
            "web_acl_arn": "",
            "xray_tracing_enabled": false
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_authorizer.cognito",
            "aws_api_gateway_deployment.main",
            "aws_api_gateway_integration.results_get_dynamodb",
            "aws_api_gateway_integration.results_options_mock",
            "aws_api_gateway_integration.uploads_options_mock",
            "aws_api_gateway_integration.uploads_post_lambda",
            "aws_api_gateway_method.results_get",
            "aws_api_gateway_method.results_options",
            "aws_api_gateway_method.uploads_options",
            "aws_api_gateway_method.uploads_post",
            "aws_api_gateway_resource.results",
            "aws_api_gateway_resource.results_proxy",
            "aws_api_gateway_resource.uploads",
            "aws_api_gateway_rest_api.main",
            "aws_cloudfront_distribution.site",
            "aws_cognito_user_pool.main",
            "aws_dynamodb_table.rekognition_cache",
            "aws_iam_role.api_gateway_dynamodb_role",
            "aws_iam_role.presigned_url_lambda_role",
            "aws_lambda_function.presigned_url_lambda",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket.image_uploads",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "data.archive_file.presigned_url_lambda_zip",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cloudfront_distribution",
      "name": "site",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "aliases": [],
            "arn": "arn:aws:cloudfront::122996776574:distribution/E1AAZJGBIBOOXK",
            "caller_reference": "terraform-20250826104646408500000004",
            "comment": "Distribution for ImageAnalyzer",
            "continuous_deployment_policy_id": "",
            "custom_error_response": [],
            "default_cache_behavior": [
              {
                "allowed_methods": [
                  "GET",
                  "HEAD"
                ],
                "cache_policy_id": "",
                "cached_methods": [
                  "GET",
                  "HEAD"
                ],
                "compress": false,
                "default_ttl": 3600,
                "field_level_encryption_id": "",
                "forwarded_values": [
                  {
                    "cookies": [
                      {
                        "forward": "none",
                        "whitelisted_names": []
                      }
                    ],
                    "headers": [],
                    "query_string": false,
                    "query_string_cache_keys": []
                  }
                ],
                "function_association": [],
                "grpc_config": [
                  {
                    "enabled": false
                  }
                ],
                "lambda_function_association": [],
                "max_ttl": 86400,
                "min_ttl": 0,
                "origin_request_policy_id": "",
                "realtime_log_config_arn": "",
                "response_headers_policy_id": "",
                "smooth_streaming": false,
                "target_origin_id": "S3-imageanalyzer-frontend-s9xyghzy",
                "trusted_key_groups": [],
                "trusted_signers": [],
                "viewer_protocol_policy": "redirect-to-https"
              }
            ],
            "default_root_object": "login.html",
            "domain_name": "d1oa4h4op5s1tl.cloudfront.net",
            "enabled": true,
            "etag": "E2UQ6TOGPVWURQ",
            "hosted_zone_id": "Z2FDTNDATAQYW2",
            "http_version": "http2",
            "id": "E1AAZJGBIBOOXK",
            "in_progress_validation_batches": 0,
            "is_ipv6_enabled": true,
            "last_modified_time": "2025-08-26 10:46:46.929 +0000 UTC",
            "logging_config": [],
            "ordered_cache_behavior": [],
            "origin": [
              {
                "connection_attempts": 3,
                "connection_timeout": 10,
                "custom_header": [],
                "custom_origin_config": [
                  {
                    "http_port": 80,
                    "https_port": 443,
                    "origin_keepalive_timeout": 5,
                    "origin_protocol_policy": "http-only",
                    "origin_read_timeout": 30,
                    "origin_ssl_protocols": [
                      "TLSv1.2"
                    ]
                  }
                ],
                "domain_name": "imageanalyzer-frontend-s9xyghzy.s3-website-us-west-2.amazonaws.com",
                "origin_access_control_id": "",
                "origin_id": "S3-imageanalyzer-frontend-s9xyghzy",
                "origin_path": "",
                "origin_shield": [],
                "s3_origin_config": [],
                "vpc_origin_config": []
              }
            ],
            "origin_group": [],
            "price_class": "PriceClass_All",
            "restrictions": [
              {
                "geo_restriction": [
                  {
                    "locations": [],
                    "restriction_type": "none"
                  }
                ]
              }
            ],
            "retain_on_delete": false,
            "staging": false,
            "status": "Deployed",
            "tags": {},
            "tags_all": {},
            "trusted_key_groups": [
              {
                "enabled": false,
                "items": []
              }
            ],
            "trusted_signers": [
              {
                "enabled": false,
                "items": []
              }
            ],
            "viewer_certificate": [
              {
                "acm_certificate_arn": "",
                "cloudfront_default_certificate": true,
                "iam_certificate_id": "",
                "minimum_protocol_version": "TLSv1",
                "ssl_support_method": ""
              }
            ],
            "wait_for_deployment": true,
            "web_acl_id": "arn:aws:wafv2:us-east-1:122996776574:global/webacl/ImageAnalyzerWebACL/0435846a-bcaf-4768-a3d9-74f9dea0cbc0"
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "random_string.suffix"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cognito_user_pool",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_recovery_setting": [
              {
                "recovery_mechanism": [
                  {
                    "name": "verified_email",
                    "priority": 1
                  },
                  {
                    "name": "verified_phone_number",
                    "priority": 2
                  }
                ]
              }
            ],
            "admin_create_user_config": [
              {
                "allow_admin_create_user_only": false,
                "invite_message_template": []
              }
            ],
            "alias_attributes": null,
            "arn": "arn:aws:cognito-idp:us-west-2:122996776574:userpool/us-west-2_odqCHUdYl",
            "auto_verified_attributes": [
              "email"
            ],
            "creation_date": "2025-08-26T10:46:41Z",
            "custom_domain": "",
            "deletion_protection": "INACTIVE",
            "device_configuration": [],
            "domain": "imageanalyzer-domain-s9xyghzy",
            "email_configuration": [
              {
                "configuration_set": "",
                "email_sending_account": "COGNITO_DEFAULT",
                "from_email_address": "",
                "reply_to_email_address": "",
                "source_arn": ""
              }
            ],
            "email_mfa_configuration": [],
            "email_verification_message": "",
            "email_verification_subject": "",
            "endpoint": "cognito-idp.us-west-2.amazonaws.com/us-west-2_odqCHUdYl",
            "estimated_number_of_users": 1,
            "id": "us-west-2_odqCHUdYl",
            "lambda_config": [],
            "last_modified_date": "2025-08-26T10:46:41Z",
            "mfa_configuration": "OFF",
            "name": "ImageAnalyzerUserPool",
            "password_policy": [
              {
                "minimum_length": 8,
                "password_history_size": 0,
                "require_lowercase": true,
                "require_numbers": true,
                "require_symbols": true,
                "require_uppercase": true,
                "temporary_password_validity_days": 7
              }
            ],
            "schema": [],
            "sign_in_policy": [
              {
                "allowed_first_auth_factors": [
                  "PASSWORD"
                ]
              }
            ],
            "sms_authentication_message": "",
            "sms_configuration": [],
            "sms_verification_message": "",
            "software_token_mfa_configuration": [],
            "tags": {},
            "tags_all": {},
            "user_attribute_update_settings": [],
            "user_pool_add_ons": [],
            "user_pool_tier": "ESSENTIALS",
            "username_attributes": [
              "email"
            ],
            "username_configuration": [],
            "verification_message_template": [
              {
                "default_email_option": "CONFIRM_WITH_CODE",
                "email_message": "",
                "email_message_by_link": "",
                "email_subject": "",
                "email_subject_by_link": "",
                "sms_message": ""
              }
            ],
            "web_authn_configuration": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cognito_user_pool_client",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "access_token_validity": 0,
            "allowed_oauth_flows": [
              "code",
              "implicit"
            ],
            "allowed_oauth_flows_user_pool_client": true,
            "allowed_oauth_scopes": [
              "email",
              "openid",
              "profile"
            ],
            "analytics_configuration": [],
            "auth_session_validity": 3,
            "callback_urls": [
              "https://d1oa4h4op5s1tl.cloudfront.net/index.html"
            ],
            "client_secret": "",
            "default_redirect_uri": "",
            "enable_propagate_additional_user_context_data": false,
            "enable_token_revocation": true,
            "explicit_auth_flows": [],
            "generate_secret": false,
            "id": "5pa9rqp0gkkivk3ttek5v8dov7",
            "id_token_validity": 0,
            "logout_urls": [
              "https://d1oa4h4op5s1tl.cloudfront.net/login.html"
            ],
            "name": "ImageAnalyzerAppClient",
            "prevent_user_existence_errors": "",
            "read_attributes": [],
            "refresh_token_rotation": [],
            "refresh_token_validity": 30,
            "supported_identity_providers": [
              "COGNITO"
            ],
            "token_validity_units": [],
            "user_pool_id": "us-west-2_odqCHUdYl",
            "write_attributes": []
          },
          "sensitive_attributes": [],
          "dependencies": [
            "aws_cloudfront_distribution.site",
            "aws_cognito_user_pool.main",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_cognito_user_pool_domain",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "aws_account_id": "122996776574",
            "certificate_arn": "",
            "cloudfront_distribution": "dpp0gtxikpq3y.cloudfront.net",
            "cloudfront_distribution_arn": "dpp0gtxikpq3y.cloudfront.net",
            "cloudfront_distribution_zone_id": "Z2FDTNDATAQYW2",
            "domain": "imageanalyzer-domain-s9xyghzy",
            "id": "imageanalyzer-domain-s9xyghzy",
            "managed_login_version": 1,
            "s3_bucket": "aws-cognito-prod-pdx-assets",
            "user_pool_id": "us-west-2_odqCHUdYl",
            "version": "20250826104642"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cognito_user_pool.main",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_dynamodb_table",
      "name": "rekognition_cache",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:dynamodb:us-west-2:122996776574:table/ImageAnalyzerCache",
            "attribute": [
              {
                "name": "ImageKey",
                "type": "S"
              }
            ],
            "billing_mode": "PAY_PER_REQUEST",
            "deletion_protection_enabled": false,
            "global_secondary_index": [],
            "hash_key": "ImageKey",
            "id": "ImageAnalyzerCache",
            "import_table": [],
            "local_secondary_index": [],
            "name": "ImageAnalyzerCache",
            "on_demand_throughput": [],
            "point_in_time_recovery": [
              {
                "enabled": false,
                "recovery_period_in_days": 0
              }
            ],
            "range_key": null,
            "read_capacity": 0,
            "replica": [],
            "restore_date_time": null,
            "restore_source_name": null,
            "restore_source_table_arn": null,
            "restore_to_latest_time": null,
            "server_side_encryption": [],
            "stream_arn": "",
            "stream_enabled": false,
            "stream_label": "",
            "stream_view_type": "",
            "table_class": "STANDARD",
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "ttl": [
              {
                "attribute_name": "",
                "enabled": false
              }
            ],
            "write_capacity": 0
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "api_gateway_dynamodb_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::122996776574:role/ImageAnalyzerApiGatewayDynamoDBRole",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"apigateway.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-08-26T10:46:40Z",
            "description": "",
            "force_detach_policies": false,
            "id": "ImageAnalyzerApiGatewayDynamoDBRole",
            "inline_policy": [],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/AmazonDynamoDBReadOnlyAccess"
            ],
            "max_session_duration": 3600,
            "name": "ImageAnalyzerApiGatewayDynamoDBRole",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROARZIZN3Z7J6IA5HJCV"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "presigned_url_lambda_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::122996776574:role/ImageAnalyzerPresignedUrlLambdaRole",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-08-26T10:46:40Z",
            "description": "",
            "force_detach_policies": false,
            "id": "ImageAnalyzerPresignedUrlLambdaRole",
            "inline_policy": [
              {
                "name": "ImageAnalyzerPresignedUrlLambdaPermissions",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":\"s3:PutObject\",\"Effect\":\"Allow\",\"Resource\":\"arn:aws:s3:::imageanalyzer-uploads-s9xyghzy/*\"}]}"
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "ImageAnalyzerPresignedUrlLambdaRole",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROARZIZN3Z7AXLGOG2JU"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "writer_lambda_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::122996776574:role/ImageAnalyzerWriterLambdaRole",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-08-26T10:46:40Z",
            "description": "",
            "force_detach_policies": false,
            "id": "ImageAnalyzerWriterLambdaRole",
            "inline_policy": [
              {
                "name": "ImageAnalyzerWriterLambdaPermissions",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"s3:GetObject\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:s3:::imageanalyzer-uploads-s9xyghzy/*\"},{\"Action\":[\"rekognition:DetectLabels\"],\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":[\"dynamodb:PutItem\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:dynamodb:us-west-2:122996776574:table/ImageAnalyzerCache\"},{\"Action\":[\"sns:Publish\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:sns:us-west-2:122996776574:ImageAnalyzerNotifications\"}]}"
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "ImageAnalyzerWriterLambdaRole",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROARZIZN3Z7HBJ2NXYA7"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "presigned_url_lambda_permissions",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "ImageAnalyzerPresignedUrlLambdaRole:ImageAnalyzerPresignedUrlLambdaPermissions",
            "name": "ImageAnalyzerPresignedUrlLambdaPermissions",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":\"s3:PutObject\",\"Effect\":\"Allow\",\"Resource\":\"arn:aws:s3:::imageanalyzer-uploads-s9xyghzy/*\"}]}",
            "role": "ImageAnalyzerPresignedUrlLambdaRole"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.presigned_url_lambda_role",
            "aws_s3_bucket.image_uploads",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "writer_lambda_permissions",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "ImageAnalyzerWriterLambdaRole:ImageAnalyzerWriterLambdaPermissions",
            "name": "ImageAnalyzerWriterLambdaPermissions",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"s3:GetObject\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:s3:::imageanalyzer-uploads-s9xyghzy/*\"},{\"Action\":[\"rekognition:DetectLabels\"],\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":[\"dynamodb:PutItem\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:dynamodb:us-west-2:122996776574:table/ImageAnalyzerCache\"},{\"Action\":[\"sns:Publish\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:sns:us-west-2:122996776574:ImageAnalyzerNotifications\"}]}",
            "role": "ImageAnalyzerWriterLambdaRole"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_dynamodb_table.rekognition_cache",
            "aws_iam_role.writer_lambda_role",
            "aws_s3_bucket.image_uploads",
            "aws_sns_topic.notifications",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "api_gateway_dynamodb_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "ImageAnalyzerApiGatewayDynamoDBRole-20250826104641818500000003",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonDynamoDBReadOnlyAccess",
            "role": "ImageAnalyzerApiGatewayDynamoDBRole"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.api_gateway_dynamodb_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "presigned_url_lambda_basic_execution",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "ImageAnalyzerPresignedUrlLambdaRole-20250826104641624500000001",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "ImageAnalyzerPresignedUrlLambdaRole"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.presigned_url_lambda_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "writer_lambda_basic_execution",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "ImageAnalyzerWriterLambdaRole-20250826104641654500000002",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "ImageAnalyzerWriterLambdaRole"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.writer_lambda_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "presigned_url_lambda",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "architectures": [
              "x86_64"
            ],
            "arn": "arn:aws:lambda:us-west-2:122996776574:function:ImageAnalyzerPresignedUrlLambda",
            "code_sha256": "ro9CWOoWnFuMDdwI5TW0Fg4kxQro5uyqhPa1OLu1Yq0=",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "CLOUDFRONT_URL": "https://d1oa4h4op5s1tl.cloudfront.net",
                  "UPLOAD_BUCKET_NAME": "imageanalyzer-uploads-s9xyghzy"
                }
              }
            ],
            "ephemeral_storage": [
              {
                "size": 512
              }
            ],
            "file_system_config": [],
            "filename": "./lambda_functions/presigned_url_lambda.zip",
            "function_name": "ImageAnalyzerPresignedUrlLambda",
            "handler": "main.lambda_handler",
            "id": "ImageAnalyzerPresignedUrlLambda",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:122996776574:function:ImageAnalyzerPresignedUrlLambda/invocations",
            "kms_key_arn": "",
            "last_modified": "2025-08-26T11:28:26.000+0000",
            "layers": [],
            "logging_config": [
              {
                "application_log_level": "",
                "log_format": "Text",
                "log_group": "/aws/lambda/ImageAnalyzerPresignedUrlLambda",
                "system_log_level": ""
              }
            ],
            "memory_size": 128,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:122996776574:function:ImageAnalyzerPresignedUrlLambda:$LATEST",
            "qualified_invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:122996776574:function:ImageAnalyzerPresignedUrlLambda:$LATEST/invocations",
            "replace_security_groups_on_destroy": null,
            "replacement_security_group_ids": null,
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::122996776574:role/ImageAnalyzerPresignedUrlLambdaRole",
            "runtime": "python3.9",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "skip_destroy": false,
            "snap_start": [],
            "source_code_hash": "QbXoB0gX7Wg8QqQmdlNTJ+EGRHxqOD/Ucsw2k9QYuI8=",
            "source_code_size": 909,
            "tags": {},
            "tags_all": {},
            "timeout": 3,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19",
          "dependencies": [
            "aws_cloudfront_distribution.site",
            "aws_iam_role.presigned_url_lambda_role",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket.image_uploads",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "data.archive_file.presigned_url_lambda_zip",
            "random_string.suffix"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "writer_lambda",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "architectures": [
              "x86_64"
            ],
            "arn": "arn:aws:lambda:us-west-2:122996776574:function:ImageAnalyzerWriterLambda",
            "code_sha256": "r12Ry2jHmXxu4/o4CITBcuhMB2zo+R0cfLYgOYTO2Fg=",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "DYNAMODB_TABLE_NAME": "ImageAnalyzerCache",
                  "SNS_TOPIC_ARN": "arn:aws:sns:us-west-2:122996776574:ImageAnalyzerNotifications"
                }
              }
            ],
            "ephemeral_storage": [
              {
                "size": 512
              }
            ],
            "file_system_config": [],
            "filename": "./lambda_functions/writer_lambda.zip",
            "function_name": "ImageAnalyzerWriterLambda",
            "handler": "main.lambda_handler",
            "id": "ImageAnalyzerWriterLambda",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:122996776574:function:ImageAnalyzerWriterLambda/invocations",
            "kms_key_arn": "",
            "last_modified": "2025-08-26T10:46:50.779+0000",
            "layers": [],
            "logging_config": [
              {
                "application_log_level": "",
                "log_format": "Text",
                "log_group": "/aws/lambda/ImageAnalyzerWriterLambda",
                "system_log_level": ""
              }
            ],
            "memory_size": 128,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:122996776574:function:ImageAnalyzerWriterLambda:$LATEST",
            "qualified_invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:122996776574:function:ImageAnalyzerWriterLambda:$LATEST/invocations",
            "replace_security_groups_on_destroy": null,
            "replacement_security_group_ids": null,
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::122996776574:role/ImageAnalyzerWriterLambdaRole",
            "runtime": "python3.9",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "skip_destroy": false,
            "snap_start": [],
            "source_code_hash": "r12Ry2jHmXxu4/o4CITBcuhMB2zo+R0cfLYgOYTO2Fg=",
            "source_code_size": 678,
            "tags": {},
            "tags_all": {},
            "timeout": 30,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19",
          "dependencies": [
            "aws_dynamodb_table.rekognition_cache",
            "aws_iam_role.writer_lambda_role",
            "aws_sns_topic.notifications",
            "data.archive_file.writer_lambda_zip"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "allow_api_gateway_to_call_presigned_url",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "ImageAnalyzerPresignedUrlLambda",
            "function_url_auth_type": null,
            "id": "AllowAPIGatewayInvoke",
            "principal": "apigateway.amazonaws.com",
            "principal_org_id": null,
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:execute-api:us-west-2:122996776574:x3mflhf5w5/*/*",
            "statement_id": "AllowAPIGatewayInvoke",
            "statement_id_prefix": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_rest_api.main",
            "aws_cloudfront_distribution.site",
            "aws_iam_role.presigned_url_lambda_role",
            "aws_lambda_function.presigned_url_lambda",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket.image_uploads",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "data.archive_file.presigned_url_lambda_zip",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "allow_s3_to_call_writer",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "ImageAnalyzerWriterLambda",
            "function_url_auth_type": null,
            "id": "AllowS3Invoke",
            "principal": "s3.amazonaws.com",
            "principal_org_id": null,
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:s3:::imageanalyzer-uploads-s9xyghzy",
            "statement_id": "AllowS3Invoke",
            "statement_id_prefix": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_dynamodb_table.rekognition_cache",
            "aws_iam_role.writer_lambda_role",
            "aws_lambda_function.writer_lambda",
            "aws_s3_bucket.image_uploads",
            "aws_sns_topic.notifications",
            "data.archive_file.writer_lambda_zip",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "frontend_hosting",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::imageanalyzer-frontend-s9xyghzy",
            "bucket": "imageanalyzer-frontend-s9xyghzy",
            "bucket_domain_name": "imageanalyzer-frontend-s9xyghzy.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "imageanalyzer-frontend-s9xyghzy.s3.us-west-2.amazonaws.com",
            "cors_rule": [],
            "force_destroy": false,
            "grant": [
              {
                "id": "6777ea920ca8d047547654f67bd792055b13b05f74794557fcdef6ca317fbde6",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z3BJ6K6RIION7M",
            "id": "imageanalyzer-frontend-s9xyghzy",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "{\"Statement\":[{\"Action\":\"s3:GetObject\",\"Effect\":\"Allow\",\"Principal\":\"*\",\"Resource\":\"arn:aws:s3:::imageanalyzer-frontend-s9xyghzy/*\",\"Sid\":\"PublicReadGetObject\"}],\"Version\":\"2012-10-17\"}",
            "region": "us-west-2",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [
              {
                "error_document": "",
                "index_document": "login.html",
                "redirect_all_requests_to": "",
                "routing_rules": ""
              }
            ],
            "website_domain": "s3-website-us-west-2.amazonaws.com",
            "website_endpoint": "imageanalyzer-frontend-s9xyghzy.s3-website-us-west-2.amazonaws.com"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "random_string.suffix"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "image_uploads",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::imageanalyzer-uploads-s9xyghzy",
            "bucket": "imageanalyzer-uploads-s9xyghzy",
            "bucket_domain_name": "imageanalyzer-uploads-s9xyghzy.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "imageanalyzer-uploads-s9xyghzy.s3.us-west-2.amazonaws.com",
            "cors_rule": [
              {
                "allowed_headers": [
                  "*"
                ],
                "allowed_methods": [
                  "POST",
                  "GET",
                  "HEAD",
                  "PUT"
                ],
                "allowed_origins": [
                  "https://d1oa4h4op5s1tl.cloudfront.net"
                ],
                "expose_headers": [
                  "ETag"
                ],
                "max_age_seconds": 0
              }
            ],
            "force_destroy": false,
            "grant": [
              {
                "id": "6777ea920ca8d047547654f67bd792055b13b05f74794557fcdef6ca317fbde6",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z3BJ6K6RIION7M",
            "id": "imageanalyzer-uploads-s9xyghzy",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-west-2",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "random_string.suffix"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_cors_configuration",
      "name": "image_uploads",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "imageanalyzer-uploads-s9xyghzy",
            "cors_rule": [
              {
                "allowed_headers": [
                  "*"
                ],
                "allowed_methods": [
                  "GET",
                  "HEAD",
                  "POST",
                  "PUT"
                ],
                "allowed_origins": [
                  "https://d1oa4h4op5s1tl.cloudfront.net"
                ],
                "expose_headers": [
                  "ETag"
                ],
                "id": "",
                "max_age_seconds": 0
              }
            ],
            "expected_bucket_owner": "",
            "id": "imageanalyzer-uploads-s9xyghzy"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudfront_distribution.site",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket.image_uploads",
            "aws_s3_bucket_public_access_block.image_uploads",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_notification",
      "name": "image_upload_trigger",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "imageanalyzer-uploads-s9xyghzy",
            "eventbridge": false,
            "id": "imageanalyzer-uploads-s9xyghzy",
            "lambda_function": [
              {
                "events": [
                  "s3:ObjectCreated:*"
                ],
                "filter_prefix": "",
                "filter_suffix": "",
                "id": "tf-s3-lambda-20250826104657520000000005",
                "lambda_function_arn": "arn:aws:lambda:us-west-2:122996776574:function:ImageAnalyzerWriterLambda"
              }
            ],
            "queue": [],
            "topic": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_dynamodb_table.rekognition_cache",
            "aws_iam_role.writer_lambda_role",
            "aws_lambda_function.writer_lambda",
            "aws_s3_bucket.image_uploads",
            "aws_sns_topic.notifications",
            "data.archive_file.writer_lambda_zip",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_policy",
      "name": "frontend_hosting",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "imageanalyzer-frontend-s9xyghzy",
            "id": "imageanalyzer-frontend-s9xyghzy",
            "policy": "{\"Statement\":[{\"Action\":\"s3:GetObject\",\"Effect\":\"Allow\",\"Principal\":\"*\",\"Resource\":\"arn:aws:s3:::imageanalyzer-frontend-s9xyghzy/*\",\"Sid\":\"PublicReadGetObject\"}],\"Version\":\"2012-10-17\"}"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket_public_access_block.frontend_hosting",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_public_access_block",
      "name": "frontend_hosting",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "block_public_acls": false,
            "block_public_policy": false,
            "bucket": "imageanalyzer-frontend-s9xyghzy",
            "id": "imageanalyzer-frontend-s9xyghzy",
            "ignore_public_acls": false,
            "restrict_public_buckets": false
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.frontend_hosting",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_public_access_block",
      "name": "image_uploads",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "block_public_acls": false,
            "block_public_policy": false,
            "bucket": "imageanalyzer-uploads-s9xyghzy",
            "id": "imageanalyzer-uploads-s9xyghzy",
            "ignore_public_acls": false,
            "restrict_public_buckets": false
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.image_uploads",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket_website_configuration",
      "name": "frontend_hosting",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bucket": "imageanalyzer-frontend-s9xyghzy",
            "error_document": [],
            "expected_bucket_owner": "",
            "id": "imageanalyzer-frontend-s9xyghzy",
            "index_document": [
              {
                "suffix": "login.html"
              }
            ],
            "redirect_all_requests_to": [],
            "routing_rule": [],
            "routing_rules": "",
            "website_domain": "s3-website-us-west-2.amazonaws.com",
            "website_endpoint": "imageanalyzer-frontend-s9xyghzy.s3-website-us-west-2.amazonaws.com"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.frontend_hosting",
            "random_string.suffix"
          ],
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_object",
      "name": "index_html",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": null,
            "arn": "arn:aws:s3:::imageanalyzer-frontend-s9xyghzy/index.html",
            "bucket": "imageanalyzer-frontend-s9xyghzy",
            "bucket_key_enabled": false,
            "cache_control": "",
            "checksum_algorithm": null,
            "checksum_crc32": "",
            "checksum_crc32c": "",
            "checksum_crc64nvme": "",
            "checksum_sha1": "",
            "checksum_sha256": "",
            "content": "\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"UTF-8\"\u003e\n    \u003ctitle\u003eImage Rekognition App\u003c/title\u003e\n    \u003cstyle\u003e\n        body { font-family: sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; line-height: 1.6; background-color: #f4f4f4; }\n        h1, h2 { color: #333; }\n        .section { display: none; background-color: white; padding: 20px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }\n        input[type=\"text\"], input[type=\"file\"] { width: 80%; padding: 8px; margin-right: 10px; border: 1px solid #ddd; border-radius: 4px; }\n        button { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }\n        button:hover { background-color: #0056b3; }\n        #results { background-color: #e9ecef; padding: 15px; border-radius: 4px; white-space: pre-wrap; word-wrap: break-word; font-family: monospace; }\n    \u003c/style\u003e\n    \u003cscript src=\"https://cdn.jsdelivr.net/npm/oidc-client-ts@2.2.0/dist/browser/oidc-client-ts.min.js\"\u003e\u003c/script\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\n    \u003ch1\u003eServerless Image Analyzer\u003c/h1\u003e\n    \u003cdiv id=\"userInfo\"\u003e\n        \u003cp\u003eAuthenticating...\u003c/p\u003e\n        \u003cpre id=\"email\"\u003e\u003c/pre\u003e\n        \u003cpre id=\"id-token\"\u003e\u003c/pre\u003e\n    \u003c/div\u003e\n    \u003cbutton id=\"signOutBtn\" style=\"display:none;\"\u003eSign Out\u003c/button\u003e\n\n    \u003cdiv id=\"app-content\" style=\"display:none;\"\u003e\n        \u003cdiv class=\"section\" id=\"upload-section\"\u003e\n            \u003ch2\u003e1. Upload a New Image\u003c/h2\u003e\n            \u003cinput type=\"file\" id=\"fileInput\" accept=\"image/jpeg, image/png\"\u003e\n            \u003cbutton id=\"uploadBtn\"\u003eUpload Image\u003c/button\u003e\n            \u003cp id=\"uploadStatus\"\u003e\u003c/p\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"section\" id=\"results-section\"\u003e\n            \u003ch2\u003e2. Get Analysis Results\u003c/h2\u003e\n            \u003cinput type=\"text\" id=\"filenameInput\" placeholder=\"Enter image filename (e.g., f50.jpg)\"\u003e\n            \u003cbutton id=\"getResultsBtn\"\u003eGet Results\u003c/button\u003e\n            \u003ch3\u003eResults:\u003c/h3\u003e\n            \u003cpre id=\"results\"\u003eAwaiting query...\u003c/pre\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n    \n    \u003cscript type=\"module\"\u003e\n        // =================================================================\n        // TEMPLATE VARIABLES - Terraform will replace these.\n        // =================================================================\n        const cognitoAuthConfig = {\n            authority: \"https://cognito-idp.us-west-2.amazonaws.com/us-west-2_odqCHUdYl\",\n            client_id: \"5pa9rqp0gkkivk3ttek5v8dov7\",\n            redirect_uri: \"https://d1oa4h4op5s1tl.cloudfront.net/index.html\",\n            post_logout_redirect_uri: \"https://d1oa4h4op5s1tl.cloudfront.net/login.html\",\n            response_type: \"code\",\n            scope: \"openid email profile\"\n        };\n        const presignedUrlApi = 'https://x3mflhf5w5.execute-api.us-west-2.amazonaws.com/prod/uploads';\n        const resultsApi = 'https://x3mflhf5w5.execute-api.us-west-2.amazonaws.com/prod/results';\n        // =================================================================\n        \n        const userManager = new oidc.UserManager(cognitoAuthConfig);\n        let accessToken = null;\n\n        userManager.signinRedirectCallback().then(user =\u003e {\n            accessToken = user.access_token;\n            document.getElementById(\"email\").textContent = \"Email: \" + user.profile.email;\n            document.getElementById(\"id-token\").textContent = \"ID Token: \" + user.id_token.substring(0, 30) + \"...\";\n            document.getElementById(\"signOutBtn\").style.display = \"block\";\n            document.getElementById(\"app-content\").style.display = \"block\";\n            document.getElementById(\"upload-section\").style.display = \"block\";\n            document.getElementById(\"results-section\").style.display = \"block\";\n        }).catch(() =\u003e { window.location.href = \"/login.html\"; });\n\n        document.getElementById(\"signOutBtn\").addEventListener(\"click\", () =\u003e userManager.signoutRedirect());\n        document.getElementById(\"uploadBtn\").addEventListener(\"click\", uploadFile);\n        document.getElementById(\"getResultsBtn\").addEventListener(\"click\", getResults);\n\n        async function uploadFile() {\n            const uploadStatusEl = document.getElementById('uploadStatus');\n            if (!accessToken) { uploadStatusEl.textContent = \"Not authenticated!\"; return; }\n            \n            const fileInput = document.getElementById('fileInput');\n            const selectedFile = fileInput.files[0];\n            \n            if (!selectedFile) { uploadStatusEl.textContent = 'Please select a file first!'; return; }\n            uploadStatusEl.textContent = \"Requesting upload data for \" + selectedFile.name + \"...\";\n\n            try {\n                const presignedResponse = await fetch(presignedUrlApi, {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json', 'Authorization': \"Bearer \" + accessToken },\n                    body: JSON.stringify({ filename: selectedFile.name, contentType: selectedFile.type })\n                });\n\n                if (!presignedResponse.ok) throw new Error(await presignedResponse.text());\n                \n                const presignedData = await presignedResponse.json();\n                const formData = new FormData();\n                Object.entries(presignedData.fields).forEach(([key, value]) =\u003e {\n                    formData.append(key, value);\n                });\n                formData.append('file', selectedFile);\n\n                await fetch(presignedData.url, {\n                    method: 'POST',\n                    mode: 'no-cors',\n                    body: formData\n                });\n                \n                uploadStatusEl.textContent = \"Success! '\" + selectedFile.name + \"' uploaded.\";\n\n            } catch (error) {\n                console.error('Upload Error:', error);\n                uploadStatusEl.textContent = \"Error: \" + error.message;\n            }\n        }\n\n        async function getResults() {\n            const resultsEl = document.getElementById('results');\n            if (!accessToken) { resultsEl.textContent = \"Not authenticated!\"; return; }\n            const filenameInput = document.getElementById('filenameInput');\n            const filename = filenameInput.value;\n            if (!filename) { resultsEl.textContent = 'Please enter a filename.'; return; }\n            resultsEl.textContent = \"Querying for \" + filename + \"...\";\n\n            try {\n                const response = await fetch(resultsApi + '/' + filename, {\n                    headers: { 'Authorization': \"Bearer \" + accessToken }\n                });\n                const data = await response.json();\n                if (!response.ok) {\n                   resultsEl.textContent = \"Error: \" + (data.message || response.statusText);\n                } else {\n                   resultsEl.textContent = JSON.stringify(data, null, 2);\n                }\n            } catch (error) {\n                console.error('Get Results Error:', error);\n                resultsEl.textContent = \"Error: \" + error.message;\n            }\n        }\n    \u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e",
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "text/html",
            "etag": "bb1fbbeee421ebaa1c3ac5ddb4506b44",
            "force_destroy": false,
            "id": "index.html",
            "key": "index.html",
            "kms_key_id": null,
            "metadata": {},
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "override_provider": [],
            "server_side_encryption": "AES256",
            "source": null,
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": {},
            "tags_all": {},
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_api_gateway_rest_api.main",
            "aws_cloudfront_distribution.site",
            "aws_cognito_user_pool.main",
            "aws_cognito_user_pool_client.main",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_object",
      "name": "login_html",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": null,
            "arn": "arn:aws:s3:::imageanalyzer-frontend-s9xyghzy/login.html",
            "bucket": "imageanalyzer-frontend-s9xyghzy",
            "bucket_key_enabled": false,
            "cache_control": "",
            "checksum_algorithm": null,
            "checksum_crc32": "",
            "checksum_crc32c": "",
            "checksum_crc64nvme": "",
            "checksum_sha1": "",
            "checksum_sha256": "",
            "content": "\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"UTF-8\"\u003e\n    \u003ctitle\u003eLogin - Image Analyzer\u003c/title\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003ch1\u003eWelcome to the Image Analyzer\u003c/h1\u003e\n    \u003cp\u003ePlease sign in to continue.\u003c/p\u003e\n    \u003cbutton id=\"signInBtn\"\u003eSign In\u003c/button\u003e\n\n    \u003c!-- Load the oidc-client-ts library from a CDN --\u003e\n    \u003cscript src=\"https://cdn.jsdelivr.net/npm/oidc-client-ts@2.2.0/dist/browser/oidc-client-ts.min.js\"\u003e\u003c/script\u003e\n\n    \u003cscript type=\"module\"\u003e\n        // --- 1. Configure your user pool app client ---\n        const cognitoAuthConfig = {\n            authority: \"https://cognito-idp.us-west-2.amazonaws.com/us-west-2_odqCHUdYl\",\n            client_id: \"5pa9rqp0gkkivk3ttek5v8dov7\",\n            redirect_uri: \"https://d1oa4h4op5s1tl.cloudfront.net/index.html\",\n            post_logout_redirect_uri: \"https://d1oa4h4op5s1tl.cloudfront.net/login.html\",\n            response_type: \"code\",\n            scope: \"openid email profile\"\n        };\n        \n        // --- 2. Create a UserManager instance ---\n        const userManager = new oidc.UserManager(cognitoAuthConfig);\n\n        // --- 3. Add a sign-in button that initiates a redirect ---\n        document.getElementById(\"signInBtn\").addEventListener(\"click\", async () =\u003e {\n            await userManager.signinRedirect();\n        });\n    \u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e",
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "text/html",
            "etag": "3fb16f8475590ede2c95ac9f04f26c72",
            "force_destroy": false,
            "id": "login.html",
            "key": "login.html",
            "kms_key_id": null,
            "metadata": {},
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "override_provider": [],
            "server_side_encryption": "AES256",
            "source": null,
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": {},
            "tags_all": {},
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_cloudfront_distribution.site",
            "aws_cognito_user_pool.main",
            "aws_cognito_user_pool_client.main",
            "aws_s3_bucket.frontend_hosting",
            "aws_s3_bucket_website_configuration.frontend_hosting",
            "aws_wafv2_web_acl.main",
            "random_string.suffix"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic",
      "name": "notifications",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_failure_feedback_role_arn": "",
            "application_success_feedback_role_arn": "",
            "application_success_feedback_sample_rate": 0,
            "archive_policy": "",
            "arn": "arn:aws:sns:us-west-2:122996776574:ImageAnalyzerNotifications",
            "beginning_archive_time": "",
            "content_based_deduplication": false,
            "delivery_policy": "",
            "display_name": "",
            "fifo_throughput_scope": "",
            "fifo_topic": false,
            "firehose_failure_feedback_role_arn": "",
            "firehose_success_feedback_role_arn": "",
            "firehose_success_feedback_sample_rate": 0,
            "http_failure_feedback_role_arn": "",
            "http_success_feedback_role_arn": "",
            "http_success_feedback_sample_rate": 0,
            "id": "arn:aws:sns:us-west-2:122996776574:ImageAnalyzerNotifications",
            "kms_master_key_id": "",
            "lambda_failure_feedback_role_arn": "",
            "lambda_success_feedback_role_arn": "",
            "lambda_success_feedback_sample_rate": 0,
            "name": "ImageAnalyzerNotifications",
            "name_prefix": "",
            "owner": "122996776574",
            "policy": "{\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Action\":[\"SNS:GetTopicAttributes\",\"SNS:SetTopicAttributes\",\"SNS:AddPermission\",\"SNS:RemovePermission\",\"SNS:DeleteTopic\",\"SNS:Subscribe\",\"SNS:ListSubscriptionsByTopic\",\"SNS:Publish\"],\"Condition\":{\"StringEquals\":{\"AWS:SourceOwner\":\"122996776574\"}},\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Resource\":\"arn:aws:sns:us-west-2:122996776574:ImageAnalyzerNotifications\",\"Sid\":\"__default_statement_ID\"}],\"Version\":\"2008-10-17\"}",
            "signature_version": 0,
            "sqs_failure_feedback_role_arn": "",
            "sqs_success_feedback_role_arn": "",
            "sqs_success_feedback_sample_rate": 0,
            "tags": {},
            "tags_all": {},
            "tracing_config": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic_subscription",
      "name": "email_subscription",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-west-2:122996776574:ImageAnalyzerNotifications:814be182-5475-4586-ac93-cea9b26ee412",
            "confirmation_timeout_in_minutes": 1,
            "confirmation_was_authenticated": false,
            "delivery_policy": "",
            "endpoint": "cosmin12300@hotmail.com",
            "endpoint_auto_confirms": false,
            "filter_policy": "",
            "filter_policy_scope": "",
            "id": "arn:aws:sns:us-west-2:122996776574:ImageAnalyzerNotifications:814be182-5475-4586-ac93-cea9b26ee412",
            "owner_id": "122996776574",
            "pending_confirmation": true,
            "protocol": "email",
            "raw_message_delivery": false,
            "redrive_policy": "",
            "replay_policy": "",
            "subscription_role_arn": "",
            "topic_arn": "arn:aws:sns:us-west-2:122996776574:ImageAnalyzerNotifications"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_sns_topic.notifications"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_wafv2_ip_set",
      "name": "country_set",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"].us-east-1",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "addresses": [],
            "arn": "arn:aws:wafv2:us-east-1:122996776574:global/ipset/ImageAnalyzerCountrySet/3a56ea8f-0d06-4783-9ab8-b283f344ed71",
            "description": "",
            "id": "3a56ea8f-0d06-4783-9ab8-b283f344ed71",
            "ip_address_version": "IPV4",
            "lock_token": "d1f5c6a3-ed93-4a44-b6cf-7597b2fd424f",
            "name": "ImageAnalyzerCountrySet",
            "name_prefix": "",
            "scope": "CLOUDFRONT",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_wafv2_web_acl",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"].us-east-1",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_integration_url": "",
            "arn": "arn:aws:wafv2:us-east-1:122996776574:global/webacl/ImageAnalyzerWebACL/0435846a-bcaf-4768-a3d9-74f9dea0cbc0",
            "association_config": [],
            "capacity": 1,
            "captcha_config": [],
            "challenge_config": [],
            "custom_response_body": [],
            "data_protection_config": [],
            "default_action": [
              {
                "allow": [],
                "block": [
                  {
                    "custom_response": []
                  }
                ]
              }
            ],
            "description": "",
            "id": "0435846a-bcaf-4768-a3d9-74f9dea0cbc0",
            "lock_token": "def4c936-f357-42b2-9ab5-44b2968b7f19",
            "name": "ImageAnalyzerWebACL",
            "name_prefix": "",
            "rule": [
              {
                "action": [
                  {
                    "allow": [
                      {
                        "custom_request_handling": []
                      }
                    ],
                    "block": [],
                    "captcha": [],
                    "challenge": [],
                    "count": []
                  }
                ],
                "captcha_config": [],
                "challenge_config": [],
                "name": "AllowCountryRule",
                "override_action": [],
                "priority": 1,
                "rule_label": [],
                "statement": [
                  {
                    "and_statement": [],
                    "asn_match_statement": [],
                    "byte_match_statement": [],
                    "geo_match_statement": [
                      {
                        "country_codes": [
                          "IL"
                        ],
                        "forwarded_ip_config": []
                      }
                    ],
                    "ip_set_reference_statement": [],
                    "label_match_statement": [],
                    "managed_rule_group_statement": [],
                    "not_statement": [],
                    "or_statement": [],
                    "rate_based_statement": [],
                    "regex_match_statement": [],
                    "regex_pattern_set_reference_statement": [],
                    "rule_group_reference_statement": [],
                    "size_constraint_statement": [],
                    "sqli_match_statement": [],
                    "xss_match_statement": []
                  }
                ],
                "visibility_config": [
                  {
                    "cloudwatch_metrics_enabled": false,
                    "metric_name": "allowCountryRule",
                    "sampled_requests_enabled": false
                  }
                ]
              }
            ],
            "rule_json": null,
            "scope": "CLOUDFRONT",
            "tags": {},
            "tags_all": {},
            "token_domains": [],
            "visibility_config": [
              {
                "cloudwatch_metrics_enabled": false,
                "metric_name": "mainWebACL",
                "sampled_requests_enabled": false
              }
            ]
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "create_before_destroy": true
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_string",
      "name": "suffix",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 2,
          "attributes": {
            "id": "s9xyghzy",
            "keepers": null,
            "length": 8,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": null,
            "result": "s9xyghzy",
            "special": false,
            "upper": false
          },
          "sensitive_attributes": [],
          "create_before_destroy": true
        }
      ]
    }
  ],
  "check_results": null
}
